# Tyk Dashboard

This chart deploys Tyk dashboard automation for K8s on a [Kubernetes](http://kubernetes.io) cluster using the [Helm](https://helm.sh) package manager.

## Prerequisites

- Kubernetes v1.16+
- Tyk Gateway
- Redis
- MongoDB

## Installing the Chart

To install the chart with the release name `tyk-dashboard`:

```console
$ helm repo add tyk-helm https://helm.tyk.io/public/helm/charts/
$ helm repo update
$ helm install tyk-dashboard tyk-helm/dashboard -n tyk --version=0.1.0
```

## Uninstalling the Chart

To uninstall/delete the `tyk-dashboard`:

```console
$ helm delete tyk-dashboard -n tyk
```

The command removes all the Kubernetes components associated with the chart and deletes the release.

## Configuration

The following table lists the configurable parameters of the `dashboard` chart and their default values.

|                Parameter                 |                                                                                                                                           Description                                                                                                                                           |                                         Default                                          |
|------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| enabled                                  | Determines whither or not the dashboard component should be installed.                                                                                                                                                                                                                          | `true`                                                                                   |
| nameOverride                             |                                                                                                                                                                                                                                                                                                 | `""`                                                                                     |
| fullnameOverride                         |                                                                                                                                                                                                                                                                                                 | `""`                                                                                     |
| podAnnotations                           |                                                                                                                                                                                                                                                                                                 | `{}`                                                                                     |
| podSecurityContext                       |                                                                                                                                                                                                                                                                                                 | `{}`                                                                                     |
| securityContext.runAsNonRoot             |                                                                                                                                                                                                                                                                                                 | `true`                                                                                   |
| securityContext.allowPrivilegeEscalation |                                                                                                                                                                                                                                                                                                 | `false`                                                                                  |
| securityContext.privileged               |                                                                                                                                                                                                                                                                                                 | `false`                                                                                  |
| securityContext.readOnlyRootFilesystem   |                                                                                                                                                                                                                                                                                                 | `true`                                                                                   |
| securityContext.capabilities             |                                                                                                                                                                                                                                                                                                 | `{"drop":["all"]}`                                                                       |
| secrets.APISecret                        | tyk_analytics.conf tyk_api_config.secret tyk_analytics.conf shared_node_secret                                                                                                                                                                                                                  | `CHANGEME`                                                                               |
| secrets.AdminSecret                      | tyk_analytics.conf admin_secret                                                                                                                                                                                                                                                                 | `"12345"`                                                                                |
| secrets.useSecretName                    | If you don't want to store plaintext secrets in the Helm value file and would rather provide the k8s Secret externally please populate the value below it should contain secrets with following keys redisPass, mongoURL, AdminSecret, APISecret, DashLicense, MDCBLicense, tibSecret           | `""`                                                                                     |
| hostName                                 | The hostname to bind the Dashboard to.                                                                                                                                                                                                                                                          | `tyk-dashboard.local`                                                                    |
| tls                                      | If set to true the Dashboard will use SSL connection. You will also need to set the: - TYK_DB_SERVEROPTIONS_CERTIFICATE_CERTFILE - TYK_DB_SERVEROPTIONS_CERTIFICATE_KEYFILE variables in extraEnvs object array to define your SSL cert and key files.                                          | `false`                                                                                  |
| license                                  | Dashboard license.                                                                                                                                                                                                                                                                              | `""`                                                                                     |
| bootstrap.enabled                        |                                                                                                                                                                                                                                                                                                 | `true`                                                                                   |
| bootstrap.adminUser                      |                                                                                                                                                                                                                                                                                                 | `{"email":"default@exmaple.com","firstName":"admin","lastName":"user","password":""}`    |
| bootstrap.org                            | Dashboard Organisation information.                                                                                                                                                                                                                                                             | `{"cname":"tyk-portal.local","name":"Default Org"}`                                      |
| replicaCount                             |                                                                                                                                                                                                                                                                                                 | `1`                                                                                      |
| containerPort                            |                                                                                                                                                                                                                                                                                                 | `3000`                                                                                   |
| image.repository                         |                                                                                                                                                                                                                                                                                                 | `tykio/tyk-dashboard`                                                                    |
| image.tag                                |                                                                                                                                                                                                                                                                                                 | `v3.2.1`                                                                                 |
| image.pullPolicy                         |                                                                                                                                                                                                                                                                                                 | `Always`                                                                                 |
| service.type                             |                                                                                                                                                                                                                                                                                                 | `NodePort`                                                                               |
| service.port                             |                                                                                                                                                                                                                                                                                                 | `3000`                                                                                   |
| service.nodePort                         |                                                                                                                                                                                                                                                                                                 | ``                                                                                       |
| autoscaling                              |                                                                                                                                                                                                                                                                                                 | `{"enabled":false,"maxReplicas":20,"minReplicas":1,"targetCPUUtilizationPercentage":80}` |
| ingress                                  | Creates an ingress object in k8s. Will require an ingress-controller and annotation to that ingress controller.                                                                                                                                                                                 | `{"annotations":{},"enabled":false,"hosts":["tyk-dashboard.local"],"path":"/","tls":[]}` |
| portal.enabled                           | Portal will only bootstrap if both the enabled and bootstrap.enabled keys are set to true. Only set this to false if you're not planning on using developer portal                                                                                                                              | `true`                                                                                   |
| portal.path                              |                                                                                                                                                                                                                                                                                                 | `/`                                                                                      |
| portal.ingress                           |                                                                                                                                                                                                                                                                                                 | `{"annotations":{},"enabled":false,"hosts":["tyk-portal.local"],"tls":[]}`               |
| resources                                |                                                                                                                                                                                                                                                                                                 | `{}`                                                                                     |
| nodeSelector                             |                                                                                                                                                                                                                                                                                                 | `{}`                                                                                     |
| tolerations                              |                                                                                                                                                                                                                                                                                                 | `[]`                                                                                     |
| affinity                                 |                                                                                                                                                                                                                                                                                                 | `{}`                                                                                     |
| extraEnvs                                |                                                                                                                                                                                                                                                                                                 | `[]`                                                                                     |
| extraMounts                              | # Additional mounts by specifying the k8s secret object and the mount path                                                                                                                                                                                                                      | `[]`                                                                                     |
| redis.storage.database                   |                                                                                                                                                                                                                                                                                                 | `0`                                                                                      |
| mongo.useSSL                             | If your MongoDB has a password you can add the username and password to the url mongoURL: mongodb://root:pass@tyk-mongo-mongodb.tyk.svc.cluster.local:27017/tyk_analytics?authSource=admin Enables SSL for MongoDB connection. MongoDB instance will have to support that. Default value: false | `false`                                                                                  |
| gateway.enabled                          | Determines whither or not the gateway component should be installed.                                                                                                                                                                                                                            | `true`                                                                                   |
| gateway.hostName                         | The hostname to bind the Gateway to.                                                                                                                                                                                                                                                            | `tyk-gw.local`                                                                           |
| gateway.endpoint                         | Gatewaty service endpoint to connect to                                                                                                                                                                                                                                                         | `http://gateway-svc.tyk.svc`                                                             |
| gateway.port                             | Gatway service port to be used when connecting                                                                                                                                                                                                                                                  | `8080`                                                                                   |
| gateway.control                          | Determines whither or not the gateway control api should run on different port.                                                                                                                                                                                                                 | `{"containerPort":9696,"enabled":false,"endpoint":"http://gateway-control-svc.tyk.svc"}` |


Specify each parameter using the `--set key=value[,key=value]` argument to `helm install`. For example:

```console
$ helm install tyk-dashboard tyk-helm/dashboard -n tyk --version=0.1.0 --set securityContext.capabilities={"drop":["all"]}
```

Alternatively, a YAML file that specifies the values for the parameters can be provided while
installing the chart. For example:

```console
$ helm install tyk-dashboard tyk-helm/dashboard -n tyk --version=0.1.0 --values values.yaml
```